2021-06-25





그간 작업이 많아서 일지를 쓰지 못했다.

지금까지 했던 작업들을 정리해보자면 



내가 했던 작업들은 기본 컨텐츠 작업 외에 



**AI 구조, Attribute Map**을 개발했다.



AI구조는 노드식 구조를 따르게 만들었다.  팀장님의 말에 따라 최대한 유연하게 구조를 잡고자 했고 나는 조언을 받으면서 노드 형태의 AI를 만들게 되었다.



현재는 기본적인 구성이지만 대략적인 개념은 이렇게 된다.



1. AI 작업의 단위는 노드이며 Begin, Update, End 의 라이프 사이클을 가진다. 그리고 노드는 AIValue라는 데이터 클래스를 가진다.
2. 노드는 자신의 작업이 성공과 실패에 따라 자신이 가진 노드를 반환한다.
3. 이 노드들의 전체의 단위를 Tree라고 정한다.
4. Tree의 관리는 AI가 가지며 이 AI는 노드 작업 큐와 노드 긴급 작업 큐를 가진다.
5. AI는 Update 주기마다(1 프레임)  긴급 큐 -> 작업 큐(긴급 큐에 노드 존재시 스킵) 순서대로 체크해서 큐에 노드가 들어있다면 void Begin(AIValue) => bool Update() =>List<Node> End() 순으로 작업을 처리한다.
6. 이 때  Node.Update() 의 반환값이 True이면 다시 해당 노드를 작업 큐 혹은 긴급 큐에 넣는다.
7. Node.Update()의 반환값이 False이면 Node.End()를 실행하며 Node.End()는 노드의 End가 성공(True)이면 자신의 TrueNodeList 를 작업큐에 올려두고 노드의 End가 실패(False)라면 자신의 FalseNodeList를 작업큐에 반환한다.
8. 해당 과정을 순회하며 AI상태를 조정한다.



노드는 현재 만든 노드로는 Move Ground Mode, Move Direction Node,  Search Node, Active Skill Node, Delay Node 등의 프로토 타입 노드들을 만든 상태이다.



우선은 State Pattern을 기본 개념으로 해서 구성해본 느낌인데. 우선 시범 동작은 그럭저럭 잘 된 것 같다. 앞으로 더 다듬어야지.





Attribute 맵 관련



이 부분은 유저가 특정 지역에 들어섰을 때. 해당 위치가 어디인지 나타낼 때. 혹은 어떤 곳을 찍었을 때 어디인지 알려주기 위해 만든 것이다.



원리 자체는 간단한데. 맵 사이즈에 (적당한 비율로) 맞춘 특수한 미니맵(지역별로 색을 칠한 미니맵)을 복사하여 픽셀 단위로 (X,Y)로 좌표화 시킨다.



만약 유저가 특정 좌표(x,y)에 들어섰거나. 맵에 특정 좌표(x,y)를 찍었을 때 특수 미니맵 픽셀을 체크해서 색을 확인한 다음 비교를 통해 여기가 어디인지 나타내주는 형태이다.



거기에 따라서 에디터도 따로 만들어 뒀다. 

